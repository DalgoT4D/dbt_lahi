{{ config(
  materialized='table',
  indexes=[
    {'columns': ['_airbyte_ab_id'], 'type': 'hash'}
  ],
  schema='intermediate'
) }}

WITH andhra_pradesh AS (
  SELECT 
    _airbyte_ab_id,
    "VC_Email_Id",
    "HM_Name",
    "Block",
    "Books___Class_9",
    "Job_Role__For_Class_11_and_12_",
    "12Boys",
    "HM_Email_Id_",
    "Sector___Trade",
    "11_Total",
    "10Girls",
    "School_Category",
    "10Boys",
    "LAB",
    "VC_Phone_Number",
    "9Girls",
    "VC_Name",
    "Year_of_Approval",
    "School_ID___UDI",
    "12_Total",
    "State",
    "11Boys",
    "VT_Mobile_Number",
    "District",
    "VTP",
    "9Boys",
    "Grand_Total",
    "12Girls",
    "Total_Boys",
    "HM_Phone_Number",
    "Job_Role__For_Class_9_and_10_",
    "VT_Email_Id",
    "Books___Class_11",
    "VT_Name_",
    "School_Management",
    "School_Status",
    "10_Total",
    "School_Type",
    "School_Name",
    "11Girls",
    "Books___Class_12",
    "VT_Status",
    "9_Total",
    "Gender",
    "Books___Class_10",
    "Division",
    "Total_Girls" as "AP_Total_Girls"
  FROM dev_intermediate.andhra_pradesh_state_database
),

assam AS (
  SELECT 
     _airbyte_ab_id,
     NULL as "VC_Email_Id",
     NULL as "HM_Name",
     NULL as "Block",
     NULL as "Books___Class_9",
     NULL as "Job_Role__For_Class_11_and_12_",
     NULL as "12Boys",
     NULL as "HM_Email_Id_",
     NULL as "Sector___Trade",
     "11_Total",
     NULL as "10Girls",
     NULL as "School_Category",
     NULL as "10Boys",
     NULL as "LAB",
     NULL as "VC_Phone_Number",
     NULL as "9Girls",
     NULL as "VC_Name", 
     NULL as "Year_of_Approval", 
     NULL as "School_ID___UDI", 
     "12_Total", 
     "State", 
     NULL as "11Boys", 
     NULL as "VT_Mobile_Number", 
     "District", 
     NULL as "VTP", 
     NULL as "9Boys", 
     "Grand_Total", 
     NULL as "12Girls", 
     "Total_Boys", 
     NULL as "HM_Phone_Number", 
     NULL as "Job_Role__For_Class_9_and_10_", 
     NULL as "VT_Email_Id", 
     NULL as "Books___Class_11", 
     NULL as "VT_Name_", 
     NULL as "School_Management", 
     NULL as "School_Status", 
     "10_Total",
     "School_Type", 
     "School_Name", 
     NULL as "11Girls", 
     NULL as "Books___Class_12", 
     NULL as "VT_Status", 
     "9_Total",
     NULL as "Gender",
     NULL as "Books___Class_10",
     NULL as "Division",
     "Total_Girls" as "Assam_Total_Girls"
FROM dev_intermediate.assam_state_database
)

SELECT * FROM andhra_pradesh
UNION ALL
SELECT * FROM assam
